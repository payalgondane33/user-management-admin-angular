<aside
  class="fixed flex flex-col top-0 left-0 h-screen ease-in-out z-50 border-r border-gray-200 bg-white text-white transition-all duration-300"
  [ngClass]="{
    'w-[260px]': (isExpanded$ | async),
    'w-[80px]': !(isExpanded$ | async),
    'translate-x-0': (isMobileOpen$ | async),
    '-translate-x-full': !(isMobileOpen$ | async),
    'xl:translate-x-0': true,
  }"
  (mouseenter)="onSidebarMouseEnter()"
  (mouseleave)="sidebarService.setHovered(false)"
>
  <div class="h-30 lg:flex items-center justify-center border-b border-white/20">
    <img
      src="/images/logo.png"
      [ngClass]="{ 'w-24': isExpanded$ | async, 'w-10': !(isExpanded$ | async) }"
    />
  </div>

  <div
    class="flex flex-col overflow-y-auto duration-300 ease-linear no-scrollbar bg-[#6b4fb6] px-5 py-6 rounded-tr-3xl overflow-hidden"
  >
    <nav class="mb-6 flex flex-col gap-4">
      <ul class="flex flex-col gap-1">
        @for (nav of navItems; track $index; let i = $index) {
          <li>
            <button
              [routerLink]="nav.path"
              routerLinkActive="bg-white/30 text-white"
              [routerLinkActiveOptions]="{ exact: true }"
              class="flex items-center gap-3 w-full rounded-lg px-3 py-2 text-sm hover:bg-white/15 transition"
              (click)="nav.subItems ? toggleSubmenu('main', i) : null"
            >
              <img src="{{ nav.icon }}" alt="{{ nav.name }}" class="w-5 h-5" />

              <span @if(isExpanded$ | async) class="flex-1 text-left">
                {{ nav.name }}
              </span>

              <svg
                *ngIf="nav.subItems && isExpanded$ | async"
                class="w-4 h-4 transition-transform"
                [class.rotate-180]="openSubmenu === 'main-' + i"
                viewBox="0 0 20 20"
                fill="none"
              >
                <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="1.5" />
              </svg>
            </button>

            <div
              [id]="'main-' + i"
              class="overflow-hidden transition-all"
              [ngStyle]="{
                height:
                  openSubmenu === 'main-' + i ? (subMenuHeights['main-' + i] || 0) + 'px' : '0px',
              }"
            >
              <ul class="ml-10 mt-1 space-y-1">
                @for (sub of nav.subItems; track $index) {
                  <li>
                    <a
                      [routerLink]="sub.path"
                      (click)="onSubmenuClick()"
                      class="block px-3 py-2 rounded-lg text-sm hover:bg-white/15"
                    >
                      {{ sub.name }}
                    </a>
                  </li>
                }
              </ul>
            </div>
          </li>
        }
      </ul>
    </nav>
  </div>
</aside>
